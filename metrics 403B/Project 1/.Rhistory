#par(mfrow=c(2,1))
plot(datats, ylab="Monthly amount of milk production", xlab="Time", lwd=2, col='skyblue3', xlim=c(1962,1975))
#plot(datats)
lines(time,mod1$fitted.values,col="red3",lwd=2)
#quadratic fit
mod2=lm(datats~time+I(time^2))
#par(mfrow=c(2,1))
plot(datats,ylab="Monthly amount of milk production", xlab="Time", lwd=2, col='skyblue3', xlim=c(1962,1975))
lines(time,mod2$fitted.values,col="red3",lwd=2)
#periodic + quadratic fit
#TODO
sin.t<-sin(2*pi*time)
cos.t<-cos(2*pi*time)
mod3=lm(datats~time+I(time^2) + sin.t + cos.t)
#par(mfrow=c(2,1))
plot(datats,ylab="Monthly amount of milk production", xlab="Time", lwd=2, col='skyblue3', xlim=c(1962,1975))
lines(time,mod3$fitted.values,col="red3",lwd=2)
#, fig.width=6, fig.height=6
#Linear Fit
mod1=lm(datats~time)
#par(mfrow=c(2,1))
plot(datats, ylab="Monthly amount of milk production", xlab="Time", lwd=2, col='skyblue3', xlim=c(1962,1975))
#plot(datats)
lines(time,mod1$fitted.values,col="red3",lwd=2)
#quadratic fit
mod2=lm(datats~time+I(time^2))
#par(mfrow=c(2,1))
plot(datats,ylab="Monthly amount of milk production", xlab="Time", lwd=2, col='skyblue3', xlim=c(1962,1975))
lines(time,mod2$fitted.values,col="red3",lwd=2)
#periodic + quadratic fit
#TODO
sin.t<-sin(pi*time)
cos.t<-cos(pi*time)
mod3=lm(datats~time+I(time^2) + sin.t + cos.t)
#par(mfrow=c(2,1))
plot(datats,ylab="Monthly amount of milk production", xlab="Time", lwd=2, col='skyblue3', xlim=c(1962,1975))
lines(time,mod3$fitted.values,col="red3",lwd=2)
#, fig.width=6, fig.height=6
#Linear Fit
mod1=lm(datats~time)
#par(mfrow=c(2,1))
plot(datats, ylab="Monthly amount of milk production", xlab="Time", lwd=2, col='skyblue3', xlim=c(1962,1975))
#plot(datats)
lines(time,mod1$fitted.values,col="red3",lwd=2)
#quadratic fit
mod2=lm(datats~time+I(time^2))
#par(mfrow=c(2,1))
plot(datats,ylab="Monthly amount of milk production", xlab="Time", lwd=2, col='skyblue3', xlim=c(1962,1975))
lines(time,mod2$fitted.values,col="red3",lwd=2)
#periodic + quadratic fit
#TODO
sin.t<-sin(2*pi*time)
cos.t<-cos(2*pi*time)
mod3=lm(datats~time+I(time^2) + sin.t + cos.t)
#par(mfrow=c(2,1))
plot(datats,ylab="Monthly amount of milk production", xlab="Time", lwd=2, col='skyblue3', xlim=c(1962,1975))
lines(time,mod3$fitted.values,col="red3",lwd=2)
#plot of residuals for linear
plot(time,mod1$residuals, ylab="Residuals",type='l',xlab="Time")
plot(time,mod2$residuals, ylab="Residuals",type='l',xlab="Time")
plot(time,mod3$residuals, ylab="Residuals",type='l',xlab="Time")
#plot of residuals for linear
plot(mod1$fitted.values,mod1$residuals, ylab="Residuals",type='l',xlab="Time")
plot(mod2$fitted.values,mod2$residuals, ylab="Residuals",type='l',xlab="Time")
plot(mod3$fitted.values,mod3$residuals, ylab="Residuals",type='l',xlab="Time")
#plot of residuals for linear
plot(mod1$fitted.values,mod1$residuals, ylab="Residuals",type='l',xlab="Fitted Value")
plot(mod2$fitted.values,mod2$residuals, ylab="Residuals",type='l',xlab="Fitted Value")
plot(mod3$fitted.values,mod3$residuals, ylab="Residuals",type='l',xlab="Fitted Value")
hist(mod1$residuals)
hist(mod1$residuals)
hist(mod2$residuals)
hist(mod3$residuals)
library(tsoutliers)
jarque.bera.test(mod1$residuals)
JarqueBera.test(mod1$residuals)
acf(mod1$residuals)
pacf(mod1$residuals)
acf(mod1$residuals)
pacf(mod1$residuals)
acf(mod2$residuals)
pacf(mod2$residuals)
acf(mod3$residuals)
pacf(mod3$residuals)
setwd('C:/Users/rossw/Documents/MAE Program/Q2/Applied Econometrics 403B/Project 1')
data = read.csv("monthly-milk-production-pounds-p.csv")
names(data) = c('date','milkproduction')
data = na.exclude(data)
attach(data)
datats = ts(milkproduction,start=1962,freq=12)
#datats = na.exclude(datats)
time = seq(1962,1975,length=length(datats))
plot.ts(datats)
#na.exclude(datats)
#, fig.width=6, fig.height=6
#Linear Fit
mod1=lm(datats~time)
#par(mfrow=c(2,1))
plot(datats, ylab="Monthly amount of milk production", xlab="Time", lwd=2, col='skyblue3', xlim=c(1962,1975))
#plot(datats)
lines(time,mod1$fitted.values,col="red3",lwd=2)
#quadratic fit
mod2=lm(datats~time+I(time^2))
#par(mfrow=c(2,1))
plot(datats,ylab="Monthly amount of milk production", xlab="Time", lwd=2, col='skyblue3', xlim=c(1962,1975))
lines(time,mod2$fitted.values,col="red3",lwd=2)
#periodic + quadratic fit
#TODO
sin.t<-sin(2*pi*time)
cos.t<-cos(2*pi*time)
mod3=lm(datats~time+I(time^2) + sin.t + cos.t)
#par(mfrow=c(2,1))
plot(datats,ylab="Monthly amount of milk production", xlab="Time", lwd=2, col='skyblue3', xlim=c(1962,1975))
lines(time,mod3$fitted.values,col="red3",lwd=2)
#, fig.width=6, fig.height=6
#Linear Fit
mod1=lm(datats~time)
#par(mfrow=c(2,1))
plot(datats, ylab="Monthly amount of milk production", xlab="Time", lwd=2, col='skyblue3', xlim=c(1962,1975))
#plot(datats)
lines(time,mod1$fitted.values,col="red3",lwd=2)
#quadratic fit
mod2=lm(datats~time+I(time^2))
#par(mfrow=c(2,1))
plot(datats,ylab="Monthly amount of milk production", xlab="Time", lwd=2, col='skyblue3', xlim=c(1962,1975))
lines(time,mod2$fitted.values,col="red3",lwd=2)
#periodic + quadratic fit
#TODO
#sin.t<-sin(2*pi*time)
cos.t<-cos(2*pi*time)
mod3=lm(datats~time+I(time^2) +  cos.t)
#par(mfrow=c(2,1))
plot(datats,ylab="Monthly amount of milk production", xlab="Time", lwd=2, col='skyblue3', xlim=c(1962,1975))
lines(time,mod3$fitted.values,col="red3",lwd=2)
#, fig.width=6, fig.height=6
#Linear Fit
mod1=lm(datats~time)
#par(mfrow=c(2,1))
plot(datats, ylab="Monthly amount of milk production", xlab="Time", lwd=2, col='skyblue3', xlim=c(1962,1975))
#plot(datats)
lines(time,mod1$fitted.values,col="red3",lwd=2)
#quadratic fit
mod2=lm(datats~time+I(time^2))
#par(mfrow=c(2,1))
plot(datats,ylab="Monthly amount of milk production", xlab="Time", lwd=2, col='skyblue3', xlim=c(1962,1975))
lines(time,mod2$fitted.values,col="red3",lwd=2)
#periodic + quadratic fit
#TODO
sin.t<-sin(2*pi*time)
cos.t<-cos(2*pi*time)
mod3=lm(datats~time+I(time^2) + sin.t + cos.t)
#par(mfrow=c(2,1))
plot(datats,ylab="Monthly amount of milk production", xlab="Time", lwd=2, col='skyblue3', xlim=c(1962,1975))
lines(time,mod3$fitted.values,col="red3",lwd=2)
summary(mod1)
AIC(mod1,mod2,mod3)
BIC(mod1,mod2,mod3)
AIC(mod1,mod2,mod3)
BIC(mod1,mod2,mod3)
cp(mod1)
AIC(mod1,mod2,mod3)
BIC(mod1,mod2,mod3)
library(locfit)
cp(mod1)
cp(mod1,mod2,mod3)
library(forecast)
plot(forecast(datats),main="Forecasts",xlab="year", ylab="Milk Production",shadecols="oldstyle")
forecast(mod1)
forecast(mod1,h = 20)
forecast(mod1,h = 20)
forecast(object = mod1,h = 20)
forecast(object = mod1$fitted.values,h = 20)
plot(forecast(object = mod1$fitted.values,h = 20))
plot(forecast(object = mod1$fitted.values,h = 20),main="Forecasts",xlab="year", ylab="Milk Production",shadecols="oldstyle")
#seasonal dummies
seasonal=tslm(datats~season)
summary(seasonal)
#plot factors (I dont think this is what he wants)
plot(datats,main="Seasonal")
lines(seasonal$fitted.values, col="red")
#plot factors (I dont think this is what he wants)
plot(seasonal$coefficients)
seasontrend = tslm(datats~season + trend)
seasontrend = tslm(datats~season + trend)
plot(seasontrend$residuals,seasontrend$fitted.values)
seasontrend = tslm(datats~season + trend)
plot(seasontrend$fitted.values,seasontrend$residuals)
summary(seasontrned)
summary(seasontrend)
JarqueBera.test(seasontrend$residuals)
ACF(seasontrend$residuals)
acf(seasontrend$residuals)
pacf(seasontrend$residuals)
plot(forecast(object = seasontrend$fitted.values,h = 20),main="Forecasts",xlab="year", ylab="Milk Production",shadecols="oldstyle")
#periodic + quadratic fit
#TODO
per
#, fig.width=6, fig.height=6
#Linear Fit
mod1=lm(datats~time)
#par(mfrow=c(2,1))
plot(datats, ylab="Monthly amount of milk production", xlab="Time", lwd=2, col='skyblue3', xlim=c(1962,1975))
#plot(datats)
lines(time,mod1$fitted.values,col="red3",lwd=2)
#quadratic fit
mod2=lm(datats~time+I(time^2))
#par(mfrow=c(2,1))
plot(datats,ylab="Monthly amount of milk production", xlab="Time", lwd=2, col='skyblue3', xlim=c(1962,1975))
lines(time,mod2$fitted.values,col="red3",lwd=2)
#periodic + quadratic fit
#TODO
sin.t<-sin(2*pi/12*time)
cos.t<-cos(2*pi/12*time)
mod3=lm(datats~time+I(time^2) + sin.t + cos.t)
#par(mfrow=c(2,1))
plot(datats,ylab="Monthly amount of milk production", xlab="Time", lwd=2, col='skyblue3', xlim=c(1962,1975))
lines(time,mod3$fitted.values,col="red3",lwd=2)
#, fig.width=6, fig.height=6
#Linear Fit
mod1=lm(datats~time)
#par(mfrow=c(2,1))
plot(datats, ylab="Monthly amount of milk production", xlab="Time", lwd=2, col='skyblue3', xlim=c(1962,1975))
#plot(datats)
lines(time,mod1$fitted.values,col="red3",lwd=2)
#quadratic fit
mod2=lm(datats~time+I(time^2))
#par(mfrow=c(2,1))
plot(datats,ylab="Monthly amount of milk production", xlab="Time", lwd=2, col='skyblue3', xlim=c(1962,1975))
lines(time,mod2$fitted.values,col="red3",lwd=2)
#periodic + quadratic fit
#TODO
sin.t<-sin(2*pi*time)
cos.t<-cos(2*pi*time)
mod3=lm(datats~ sin.t + cos.t)
#mod3=lm(datats~time+I(time^2) + sin.t + cos.t)
#par(mfrow=c(2,1))
plot(datats,ylab="Monthly amount of milk production", xlab="Time", lwd=2, col='skyblue3', xlim=c(1962,1975))
lines(time,mod3$fitted.values,col="red3",lwd=2)
#, fig.width=6, fig.height=6
#Linear Fit
mod1=lm(datats~time)
#par(mfrow=c(2,1))
plot(datats, ylab="Monthly amount of milk production", xlab="Time", lwd=2, col='skyblue3', xlim=c(1962,1975))
#plot(datats)
lines(time,mod1$fitted.values,col="red3",lwd=2)
#quadratic fit
mod2=lm(datats~time+I(time^2))
#par(mfrow=c(2,1))
plot(datats,ylab="Monthly amount of milk production", xlab="Time", lwd=2, col='skyblue3', xlim=c(1962,1975))
lines(time,mod2$fitted.values,col="red3",lwd=2)
#periodic + quadratic fit
#TODO
sin.t<-sin(2*pi*time)
cos.t<-cos(2*pi*time)
mod3=lm(datats~time+I(time^2) + sin.t + cos.t)
#par(mfrow=c(2,1))
plot(datats,ylab="Monthly amount of milk production", xlab="Time", lwd=2, col='skyblue3', xlim=c(1962,1975))
lines(time,mod3$fitted.values,col="red3",lwd=2)
#, fig.width=6, fig.height=6
#Linear Fit
mod1=lm(datats~time)
#par(mfrow=c(2,1))
plot(datats, ylab="Monthly amount of milk production", xlab="Time", lwd=2, col='skyblue3', xlim=c(1962,1975))
#plot(datats)
lines(time,mod1$fitted.values,col="red3",lwd=2)
#quadratic fit
mod2=lm(datats~time+I(time^2))
#par(mfrow=c(2,1))
plot(datats,ylab="Monthly amount of milk production", xlab="Time", lwd=2, col='skyblue3', xlim=c(1962,1975))
lines(time,mod2$fitted.values,col="red3",lwd=2)
#periodic + quadratic fit
#TODO
sin.t<-sin(2*pi*time)
cos.t<-cos(2*pi*time)
mod3=lm(datats~time + sin.t + cos.t)
#par(mfrow=c(2,1))
plot(datats,ylab="Monthly amount of milk production", xlab="Time", lwd=2, col='skyblue3', xlim=c(1962,1975))
lines(time,mod3$fitted.values,col="red3",lwd=2)
seasontrend = tslm(datats~season + trend)
plot(seasontrend$fitted.values,seasontrend$residuals)
plot(datats,ylab="Monthly amount of milk production", xlab="Time", lwd=2, col='skyblue3', xlim=c(1962,1975))
lines(time,seasontrend$fitted.values,col="red3",lwd=2)
setwd('C:/Users/rossw/Documents/MAE Program/Q2/Applied Econometrics 403B/Project 1')
data = read.csv("monthly-milk-production-pounds-p.csv",header = F)
names(data) = c('date','milkproduction')
data = na.exclude(data)
attach(data)
datats = ts(milkproduction,start=1962,freq=12)
#datats = na.exclude(datats)
time = seq(1962,1975,length=length(datats))
plot.ts(datats)
#na.exclude(datats)
#, fig.width=6, fig.height=6
#Linear Fit
mod1=lm(datats~time)
#par(mfrow=c(2,1))
plot(datats, ylab="Monthly amount of milk production", xlab="Time", lwd=2, col='skyblue3', xlim=c(1962,1975))
#plot(datats)
lines(time,mod1$fitted.values,col="red3",lwd=2)
#quadratic fit
mod2=lm(datats~time+I(time^2))
#par(mfrow=c(2,1))
plot(datats,ylab="Monthly amount of milk production", xlab="Time", lwd=2, col='skyblue3', xlim=c(1962,1975))
lines(time,mod2$fitted.values,col="red3",lwd=2)
#periodic + quadratic fit
#TODO
sin.t<-sin(2*pi*time)
cos.t<-cos(2*pi*time)
mod3=lm(datats~time+I(time^2) + sin.t + cos.t)
#par(mfrow=c(2,1))
plot(datats,ylab="Monthly amount of milk production", xlab="Time", lwd=2, col='skyblue3', xlim=c(1962,1975))
lines(time,mod3$fitted.values,col="red3",lwd=2)
#seasonal dummies
seasonal=tslm(datats~season)
summary(seasonal)
seasontrend = tslm(datats~season + trend)
plot(seasontrend$fitted.values,seasontrend$residuals)
plot(datats,ylab="Monthly amount of milk production", xlab="Time", lwd=2, col='skyblue3', xlim=c(1962,1975))
lines(time,seasontrend$fitted.values,col="red3",lwd=2)
datats
time
len(time)
length(time)
time
setwd('C:/Users/rossw/Documents/MAE Program/Q2/Applied Econometrics 403B/Project 1')
data = read.csv("monthly-milk-production-pounds-p.csv",header = F)
names(data) = c('date','milkproduction')
data = na.exclude(data)
attach(data)
datats = ts(milkproduction,start=1962,freq=12)
#datats = na.exclude(datats)
time = seq(1962,1975.9999,length=length(datats))
plot.ts(datats)
#datats
#time
#na.exclude(datats)
#, fig.width=6, fig.height=6
#Linear Fit
mod1=lm(datats~time)
#par(mfrow=c(2,1))
plot(datats, ylab="Monthly amount of milk production", xlab="Time", lwd=2, col='skyblue3', xlim=c(1962,1975))
#plot(datats)
lines(time,mod1$fitted.values,col="red3",lwd=2)
#quadratic fit
mod2=lm(datats~time+I(time^2))
#par(mfrow=c(2,1))
plot(datats,ylab="Monthly amount of milk production", xlab="Time", lwd=2, col='skyblue3', xlim=c(1962,1975))
lines(time,mod2$fitted.values,col="red3",lwd=2)
#periodic + quadratic fit
#TODO
sin.t<-sin(2*pi*time)
cos.t<-cos(2*pi*time)
mod3=lm(datats~time+I(time^2) + sin.t + cos.t)
#par(mfrow=c(2,1))
plot(datats,ylab="Monthly amount of milk production", xlab="Time", lwd=2, col='skyblue3', xlim=c(1962,1975))
lines(time,mod3$fitted.values,col="red3",lwd=2)
#plot of residuals for linear
plot(mod1$fitted.values,mod1$residuals, ylab="Residuals",type='l',xlab="Fitted Value")
plot(mod2$fitted.values,mod2$residuals, ylab="Residuals",type='l',xlab="Fitted Value")
plot(mod3$fitted.values,mod3$residuals, ylab="Residuals",type='l',xlab="Fitted Value")
#plot of residuals for linear
plot(mod1$fitted.values,mod1$residuals, ylab="Residuals",type='l',xlab="Fitted Value")
plot(mod2$fitted.values,mod2$residuals, ylab="Residuals",type='l',xlab="Fitted Value")
plot(mod3$fitted.values,mod3$residuals, ylab="Residuals",xlab="Fitted Value")
hist(mod1$residuals)
hist(mod2$residuals)
hist(mod3$residuals)
library(tsoutliers)
JarqueBera.test(mod1$residuals)
JarqueBera.test(mod2$residuals)
JarqueBera.test(mod3$residuals)
AIC(mod1,mod2,mod3)
BIC(mod1,mod2,mod3)
library(forecast)
plot(predict(mod1,h = 20,level=.95))
plot(forecast(object = mod1$fitted.values,h = 20),main="Forecasts",xlab="year", ylab="Milk Production",shadecols="oldstyle")
seasontrend = tslm(datats~time + I(time^2) + sin.t + cos.t + season)
plot(seasontrend$fitted.values,seasontrend$residuals)
plot(datats,ylab="Monthly amount of milk production", xlab="Time", lwd=2, col='skyblue3', xlim=c(1962,1975))
lines(time,seasontrend$fitted.values,col="red3",lwd=2)
setwd('C:/Users/rossw/Documents/MAE Program/Q2/Applied Econometrics 403B/Project 1')
data = read.csv("monthly-milk-production-pounds-p.csv",header = F)
names(data) = c('date','milkproduction')
data = na.exclude(data)
attach(data)
datats = ts(milkproduction,start=1962,freq=12)
#datats = na.exclude(datats)
time = seq(1962,1975.9999,length=length(datats))
plot.ts(datats,main='Monthly Milk Production From 1962 to 1975',ylab='Pounds Per Cow')
#datats
#time
#na.exclude(datats)
#acf and pcf plots
acf(datats)
pacf(datats)
#acf and pcf plots
acf(datats)
pacf(datats)
#, fig.width=6, fig.height=6
#Linear Fit
mod1=lm(datats~time)
#par(mfrow=c(2,1))
plot(datats, ylab="Monthly milk production",main='Monthly Milk Production From 1962 to 1975', xlab="Time", lwd=2, col='skyblue3', xlim=c(1962,1975))
#plot(datats)
lines(time,mod1$fitted.values,col="red3",lwd=2)
#quadratic fit
mod2=lm(datats~time+I(time^2))
#par(mfrow=c(2,1))
plot(datats,ylab="Monthly milk production",main='Monthly Milk Production From 1962 to 1975', xlab="Time", lwd=2, col='skyblue3', xlim=c(1962,1975))
lines(time,mod2$fitted.values,col="red3",lwd=2)
#periodic + quadratic fit
sin.t<-sin(2*pi*time)
cos.t<-cos(2*pi*time)
mod3=lm(datats~time+I(time^2) + sin.t + cos.t)
#par(mfrow=c(2,1))
plot(datats,ylab="Monthly milk production",main='Monthly Milk Production From 1962 to 1975', xlab="Time", lwd=2, col='skyblue3', xlim=c(1962,1975))
lines(time,mod3$fitted.values,col="red3",lwd=2)
#, fig.width=6, fig.height=6
#Linear Fit
mod1=lm(datats~time)
#par(mfrow=c(2,1))
plot(datats, ylab="Monthly milk production",main='Monthly Milk Production Linear Fit', xlab="Time", lwd=2, col='skyblue3', xlim=c(1962,1975))
#plot(datats)
lines(time,mod1$fitted.values,col="red3",lwd=2)
#quadratic fit
mod2=lm(datats~time+I(time^2))
#par(mfrow=c(2,1))
plot(datats,ylab="Monthly milk production",main='Monthly Milk Production Quadratic Fit', xlab="Time", lwd=2, col='skyblue3', xlim=c(1962,1975))
lines(time,mod2$fitted.values,col="red3",lwd=2)
#periodic + quadratic fit
sin.t<-sin(2*pi*time)
cos.t<-cos(2*pi*time)
mod3=lm(datats~time+I(time^2) + sin.t + cos.t)
#par(mfrow=c(2,1))
plot(datats,ylab="Monthly milk production",main='Monthly Milk Production Periodic Plus Quadratic Fit', xlab="Time", lwd=2, col='skyblue3', xlim=c(1962,1975))
lines(time,mod3$fitted.values,col="red3",lwd=2)
#plot of residuals for linear
plot(mod1$fitted.values,mod1$residuals, main='Residuals by Fitted Values', ylab="Residuals",type='l',xlab="Fitted Value")
plot(mod2$fitted.values,mod2$residuals, main='Residuals by Fitted Values', ylab="Residuals",type='l',xlab="Fitted Value")
plot(mod3$fitted.values,mod3$residuals, main='Residuals by Fitted Values', ylab="Residuals",xlab="Fitted Value")
#plot of residuals for linear
plot(mod1$fitted.values,mod1$residuals, main='Residuals by Fitted Values', ylab="Residuals",type='l',xlab="Fitted Value",col='red')
plot(mod2$fitted.values,mod2$residuals, main='Residuals by Fitted Values', ylab="Residuals",type='l',xlab="Fitted Value")
plot(mod3$fitted.values,mod3$residuals, main='Residuals by Fitted Values', ylab="Residuals",xlab="Fitted Value")
#plot of residuals for linear
plot(mod1$fitted.values,mod1$residuals, main='Residuals by Fitted Values', ylab="Residuals",type='l',xlab="Fitted Value",col='red')
plot(mod2$fitted.values,mod2$residuals, main='Residuals by Fitted Values', ylab="Residuals",type='l',xlab="Fitted Value",col='red')
plot(mod3$fitted.values,mod3$residuals, main='Residuals by Fitted Values', ylab="Residuals",xlab="Fitted Value",col='blue')
hist(mod1$residuals,col=c('red','blue))
hist(mod2$residuals)
hist(mod3$residuals)
hist(mod1$residuals,col=c('red','blue'))
hist(mod2$residuals)
hist(mod3$residuals)
hist(mod1$residuals,col='skyblue',xlab='Residuals')
hist(mod2$residuals)
hist(mod3$residuals)
hist(mod1$residuals,col='skyblue',xlab='Residuals',main='Residuals of Linear Fit')
hist(mod2$residuals,col='skyblue',xlab='Residuals',main='Residuals of Quadratic Fit')
hist(mod3$residuals,col='skyblue',xlab='Residuals',main='Residuals of Periodic + Quadratic Fit')
#plot factors (I dont think this is what he wants)
plot(seasonal$coefficients,col='blue')
#plot factors (I dont think this is what he wants)
plot(seasonal$coefficients,col='blue',xlab='Month',ylab='Coefficient')
#plot factors (I dont think this is what he wants)
plot(seasonal$coefficients,col='blue',xlab='Month',ylab='Coefficient',main='Seasonal Effects per month')
setwd('C:/Users/rossw/Documents/MAE Program/Q2/Applied Econometrics 403B/Project 1')
data = read.csv("monthly-milk-production-pounds-p.csv",header = F)
names(data) = c('date','milkproduction')
data = na.exclude(data)
attach(data)
datats = ts(milkproduction,start=1962,freq=12)
#datats = na.exclude(datats)
time = seq(1962,1975.91666666666,length=length(datats))
plot.ts(datats,main='Monthly Milk Production From 1962 to 1975',ylab='Pounds Per Cow')
#datats
#time
#na.exclude(datats)
#, fig.width=6, fig.height=6
#Linear Fit
mod1=lm(datats~time)
#par(mfrow=c(2,1))
plot(datats, ylab="Monthly milk production",main='Monthly Milk Production Linear Fit', xlab="Time", lwd=2, col='skyblue3', xlim=c(1962,1975))
#plot(datats)
lines(time,mod1$fitted.values,col="red3",lwd=2)
#quadratic fit
mod2=lm(datats~time+I(time^2))
#par(mfrow=c(2,1))
plot(datats,ylab="Monthly milk production",main='Monthly Milk Production Quadratic Fit', xlab="Time", lwd=2, col='skyblue3', xlim=c(1962,1975))
lines(time,mod2$fitted.values,col="red3",lwd=2)
#periodic + quadratic fit
sin.t<-sin(2*pi*time)
cos.t<-cos(2*pi*time)
mod3=lm(datats~time+I(time^2) + sin.t + cos.t)
#par(mfrow=c(2,1))
plot(datats,ylab="Monthly milk production",main='Monthly Milk Production Periodic Plus Quadratic Fit', xlab="Time", lwd=2, col='skyblue3', xlim=c(1962,1975))
lines(time,mod3$fitted.values,col="red3",lwd=2)
#seasonal dummies
seasonal=tslm(datats~season)
summary(seasonal)
seasontrend = tslm(datats~time + I(time^2) + sin.t + cos.t + season)
plot(seasontrend$fitted.values,seasontrend$residuals,col='red',xlab='Fitted Values',ylab='Residuals',main='')
plot(datats,ylab="Monthly amount of milk production", xlab="Time", lwd=2, col='skyblue3', xlim=c(1962,1975))
lines(time,seasontrend$fitted.values,col="red3",lwd=2)
seasontrend = tslm(datats~time + I(time^2) + sin.t + cos.t + season)
plot(seasontrend$fitted.values,seasontrend$residuals,col='red',xlab='Fitted Values',ylab='Residuals',main='Residuals by Fitted Values')
plot(datats,ylab="Monthly amount of milk production", xlab="Time", lwd=2, col='skyblue3', xlim=c(1962,1975))
lines(time,seasontrend$fitted.values,col="red3",lwd=2)
seasontrend = tslm(datats~time + I(time^2) + sin.t + cos.t + season)
plot(seasontrend$fitted.values,seasontrend$residuals,col='red',xlab='Fitted Values',ylab='Residuals',main='Residuals by Fitted Values')
plot(datats,ylab="Monthly amount of milk production", xlab="Time", lwd=2, col='skyblue3', xlim=c(1962,1975),main='Monthly Milk Production Total Model Fit')
lines(time,seasontrend$fitted.values,col="red3",lwd=2)
